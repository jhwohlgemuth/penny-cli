"use strict";var _interopRequireDefault=require("@babel/runtime/helpers/interopRequireDefault"),_interopRequireWildcard=require("@babel/runtime/helpers/interopRequireWildcard");require("core-js/modules/es.array.includes"),require("core-js/modules/es.array.iterator"),require("core-js/modules/es.array.sort"),require("core-js/modules/es.string.split"),Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _net=require("net"),_react=_interopRequireWildcard(require("react")),_propTypes=_interopRequireDefault(require("prop-types")),_ink=require("ink"),_chalk=require("chalk"),_figures=require("figures"),_tomoCli=require("tomo-cli"),_utils=require("../utils");const MAX_LENGTH=60,truncate=(a,b)=>{const{length:c}=a;return c<MAX_LENGTH?a:a.substring(0,b).concat("...")},getTableData=(a,b)=>{const c=b.split(".").join("_");return(a.get(c)||[]).map(a=>{const{version:b}=a;return Object.assign(a,{version:truncate(b,MAX_LENGTH-3)})})},Suggestion=({command:a,title:b})=>_react.default.createElement(_ink.Box,{flexDirection:"column",marginBottom:1},_react.default.createElement(_ink.Text,null,(0,_chalk.dim)(b)),_react.default.createElement(_ink.Text,null,"  \u21B3 ",a)),DisplaySuggestions=({service:a})=>{const b=`${_chalk.bold.magenta("HINT")}${_chalk.bold.magenta(_figures.arrowRight)} `,c=`${b}${(0,_chalk.dim)("remember to check for other NSE scripts with")} ${_chalk.bold.dim("gibu /usr/share/nmap/script -fr")}`,d=(0,_tomoCli.dict)({domain:[// DNS
{title:"Perform a \"standard\" scan and brute-force hostnames with a dictionary",command:`${_chalk.bold.green("dnsrecon")} -d ${_chalk.bold.cyan("domain")} -D /usr/share/wordlists/dnsmap.txt -t std`},{title:"Enumerate DNS information with dnsenum",command:`${_chalk.bold.green("dnsenum")} ${_chalk.bold.cyan("domain")}`},{title:"Scan for vulnerabilties with nmap",command:`${_chalk.bold.green("nmap")} --script "dns-*"${"\n    "}${c}`}],ftp:[{title:"Check for anonymous login (username: \"anonymous\", password: <nothing>)",command:`${_chalk.bold.green("nmap")} --script ftp-anon -p ${_chalk.bold.cyan("port")}`}],http:[{title:"Scan web site for vulnerabilties with nikto",command:`${_chalk.bold.green("nikto")} -host ${_chalk.bold.cyan("ip")} -port ${_chalk.bold.cyan("port")}`},{title:"Scan web server directories with gobuster",command:`${_chalk.bold.green("gobuster")} dir -w ${_chalk.bold.cyan("/path/to/wordlist")} -u http://${_chalk.bold.cyan("ip")}:${_chalk.bold.cyan("port")}`},{title:"Scan web server directories with dirb",command:`${_chalk.bold.green("dirb")} http://${_chalk.bold.cyan("ip")} ${_chalk.bold.cyan("/path/to/wordlist")}`},{title:"Perform a \"quicklook\" at the website content in your terminal",command:`${_chalk.bold.green("curl")} -s http://${_chalk.bold.cyan("ip")}:${_chalk.bold.cyan("port")} | ${_chalk.bold.green("html2text")} -style pretty`},{title:"View colorized header data and website content with httpie",command:`${_chalk.bold.green("http")} ${_chalk.bold.cyan("ip")}:${_chalk.bold.cyan("port")}`},{title:"Fingerprint web server with whatweb",command:`${_chalk.bold.green("whatweb")} -a 3 ${_chalk.bold.cyan("ip")}:${_chalk.bold.cyan("port")}`},{title:"Brute force a GET/POST login page with hydra",command:`${_chalk.bold.red("under construction")}`},{title:"Brute force Wordpress login page with hydra",command:`${_chalk.bold.red("under construction")}${"\n    "}${c}`},{title:"Detect WebDAV installations",command:`${_chalk.bold.green("nmap")} ${_chalk.bold.cyan("ip")} --script "http-webdav-scan" -p ${_chalk.bold.cyan("port")}`},{title:"Scan for an IIS 5.1/6.0 WebDAV vulnerability",command:`${_chalk.bold.green("nmap")} ${_chalk.bold.cyan("ip")} --script "http-iis-webdav-vuln" -p ${_chalk.bold.cyan("port")}`},{title:"Determine if enabled DAV services are exploitable",command:`${_chalk.bold.green("davtest")} -url http://${_chalk.bold.cyan("ip")}`}],nfs:[{title:"Enumerate NFS with rpcinfo",command:`${_chalk.bold.green("rcpinfo")} -p ${_chalk.bold.cyan("ip")}${"\n    "}${_chalk.bold.green("showmount")} -a ${_chalk.bold.cyan("ip")}`},{title:"Run nmap scripts",command:`${_chalk.bold.green("nmap")} --script "nfs-*"`}],"netbios-ssn":[// SMB
{title:"Enumerate SMB users with nmap",command:`${_chalk.bold.green("nmap")} --script smb-enum-users -p ${_chalk.bold.cyan("port")}`},{title:"Enumerate SMB shares with nmap",command:`${_chalk.bold.green("nmap")} --script smb-enum-shares -p ${_chalk.bold.cyan("port")}${"\n    "}${c}`},{title:"Enumerate with enum4linux",command:`${_chalk.bold.green("enum4linux")} -a ${_chalk.bold.cyan("ip")}`},{title:"Connect to share",command:`${_chalk.bold.green("smbclient")} ${_chalk.bold.cyan("//mount/share")}`},{title:"Attempt null connect",command:`${_chalk.bold.green("rpcclient")} -U "" ${_chalk.bold.cyan("ip")}`}],smtp:[{title:"Scan SMTP users with nmap",command:`${_chalk.bold.green("nmap")} ${_chalk.bold.cyan("ip")} --script "smtp-enum-users" -p ${_chalk.bold.cyan("port")}`},{title:"Scan for vulnerabilties with nmap",command:`${_chalk.bold.green("nmap")} ${_chalk.bold.cyan("ip")} --script "smtp-vuln-*"${"\n    "}${c}`}],snmp:[{title:"Brute force community strings",command:`${_chalk.bold.green("onesixtyone")} -i ${_chalk.bold.cyan("/path/to/hosts")} -c ${_chalk.bold.cyan("/path/to/strings")}`},{title:"Enumerate with snmp-check",command:`${_chalk.bold.green("snmp-check")} ${_chalk.bold.cyan("ip")}`},{title:"Enumerate Windows information with snmpwalk",command:`${_chalk.bold.cyan("snmpwalk")} -c ${_chalk.bold.cyan("community")} -v1 ${_chalk.bold.cyan("ip")} ${_chalk.bold.cyan("oid")}`}],ssh:[{title:"Brute force login password with hydra",command:`${_chalk.bold.green("hydra")} -l ${_chalk.bold.cyan("user")} -P ${_chalk.bold.cyan("/path/to/password/list")} -f -V ${_chalk.bold.cyan("ip")}`}],"ssl/http":[// https
{title:"Evaluate the web server SSL/TLS (HTTPS) security with tlssled",command:`${_chalk.bold.green("tlssled")} ${_chalk.bold.cyan("ip")} ${_chalk.bold.cyan("port")}`},{title:"Analyze server SSL configuration with \"regular\" sslyze scan",command:`${_chalk.bold.green("sslyze")} --regular ${_chalk.bold.cyan("ip")}`},{title:"Enumerate SSL ciphers with nmap",command:`${_chalk.bold.green("nmap")} ${_chalk.bold.cyan("ip")} --script ssl-enum-ciphers -p ${_chalk.bold.cyan("port")}${"\n    "}${c}`}]}),e=[{title:`Sorry, no suggestions for ${(0,_chalk.bold)(a)}...`,command:`Don't forget to TRY HARDER! You can do it!`}],f=d.has(a)?d.get(a):e;return _react.default.createElement(_ink.Box,{flexDirection:"column",marginTop:1,marginLeft:1},f.map(({command:a,title:b},c)=>_react.default.createElement(Suggestion,{title:b,command:a,key:c})))},NoResults=({ip:a})=>{const b=a=>"string"==typeof a&&0<a.length;return _react.default.createElement(_ink.Box,{flexDirection:"column"},_react.default.createElement(_ink.Box,null,_react.default.createElement(_ink.Text,null,"No suggestions for "),_react.default.createElement(_ink.Color,{bold:!0,red:!0},b(a)?a:"nothing")),b(a)?_react.default.createElement(_react.Fragment,null):_react.default.createElement(Note,{message:"Try \"pwngoal scan ports --ip <IP> [--udp|--udpOnly]\" to get some data to show"}))},Note=({message:a})=>_react.default.createElement(_ink.Box,{marginBottom:2,marginLeft:1},"\u21B3 ",_react.default.createElement(_ink.Color,{dim:!0},a)),SelectTarget=({descriptions:a,fallback:b,store:c})=>{const[d,e]=(0,_react.useState)(""),[f,g]=(0,_react.useState)(void 0),h=[...c].map(([a])=>a).filter(a=>!["tcp","udp"].includes(a)).map(a=>a.split("_").join(".")).filter(a=>0<(0,_net.isIP)(a)).sort((0,_utils.byIpAddress)()).map(a=>({value:a,label:a}));return 0<h.length?f?_react.default.createElement(SelectService,{data:f,descriptions:a,title:d}):_react.default.createElement(_tomoCli.SubCommandSelect,{descriptions:Object.assign(a,{default:b}),items:h,onSelect:({value:a})=>{const b=getTableData(c,a);e(a),g(b)}}):_react.default.createElement(NoResults,null)},SelectService=({data:a,descriptions:b})=>{const[c,d]=(0,_react.useState)(void 0),e=a.map(({service:a})=>a).filter(a=>!(a.endsWith("?")||a.includes("unknown"))).reduce((a,b)=>a.includes(b)?a:[...a,b],[]).map(a=>({value:a,label:a}));return 0<e.length?c?_react.default.createElement(DisplaySuggestions,{service:c}):_react.default.createElement(_tomoCli.SubCommandSelect,{descriptions:Object.assign(b,{default:a=>`Show suggestions for ${a}`}),items:e,onSelect:({value:a})=>{d(a)}}):_react.default.createElement(NoResults,null)},SuggestCommand=({descriptions:a,options:b,store:c,terms:d})=>{const{ip:e}=b,[f]=d,g=f||e,h=getTableData(c,g);return f===void 0&&""===e?_react.default.createElement(SelectTarget,{store:c,descriptions:a,fallback:a=>`Select service for ${a}`}):0===h.length?_react.default.createElement(NoResults,{ip:g}):_react.default.createElement(SelectService,{data:h,descriptions:a,title:g})};DisplaySuggestions.propTypes={service:_propTypes.default.string},NoResults.propTypes={ip:_propTypes.default.string},Note.propTypes={message:_propTypes.default.string},SelectService.propTypes={data:_propTypes.default.array,descriptions:_propTypes.default.object},SelectTarget.propTypes={descriptions:_propTypes.default.object,fallback:_propTypes.default.oneOfType([_propTypes.default.string,_propTypes.default.func]),store:_propTypes.default.oneOfType([_propTypes.default.array,_propTypes.default.object])},SuggestCommand.propTypes={descriptions:_propTypes.default.object,options:_propTypes.default.object,store:_propTypes.default.oneOfType([_propTypes.default.array,_propTypes.default.object]),terms:_propTypes.default.array},Suggestion.propTypes={command:_propTypes.default.string,title:_propTypes.default.string};var _default=SuggestCommand;exports.default=_default;